2024-12-02 17:22:40,835 - __main__ - INFO - Starting prediction process for AAPL
2024-12-02 17:22:41,213 - __main__ - INFO - Downloaded 501 days of historical data
2024-12-02 17:22:41,233 - __main__ - INFO - Calculated technical indicators
2024-12-02 17:22:41,233 - __main__ - INFO - Preparing data for training...
2024-12-02 17:22:41,238 - __main__ - INFO - Optimizing hyperparameters...
2024-12-02 17:24:06,843 - __main__ - INFO - Best trial: {'xgb_n_estimators': 465, 'xgb_max_depth': 4, 'xgb_learning_rate': 0.02227077865660282, 'xgb_subsample': 0.6044296892532814, 'xgb_colsample_bytree': 0.6707126984623745, 'xgb_min_child_weight': 5, 'xgb_gamma': 5.527856763414975e-08, 'xgb_reg_alpha': 1.566207935542941e-07, 'xgb_reg_lambda': 1.0904574611059596e-05, 'lgb_n_estimators': 362, 'lgb_max_depth': 3, 'lgb_learning_rate': 0.0779990379156062, 'lgb_subsample': 0.6750872776583582, 'lgb_colsample_bytree': 0.9752660076568755, 'lgb_min_child_samples': 9, 'lgb_reg_alpha': 4.164722875422037e-08, 'lgb_reg_lambda': 1.8940092045893973e-05, 'lgb_min_split_gain': 0.0004729375363927215}
2024-12-02 17:24:06,843 - __main__ - INFO - Best score: 0.47772727272727267
2024-12-02 17:24:06,844 - __main__ - INFO - Best parameters: {'xgb_n_estimators': 465, 'xgb_max_depth': 4, 'xgb_learning_rate': 0.02227077865660282, 'xgb_subsample': 0.6044296892532814, 'xgb_colsample_bytree': 0.6707126984623745, 'xgb_min_child_weight': 5, 'xgb_gamma': 5.527856763414975e-08, 'xgb_reg_alpha': 1.566207935542941e-07, 'xgb_reg_lambda': 1.0904574611059596e-05, 'lgb_n_estimators': 362, 'lgb_max_depth': 3, 'lgb_learning_rate': 0.0779990379156062, 'lgb_subsample': 0.6750872776583582, 'lgb_colsample_bytree': 0.9752660076568755, 'lgb_min_child_samples': 9, 'lgb_reg_alpha': 4.164722875422037e-08, 'lgb_reg_lambda': 1.8940092045893973e-05, 'lgb_min_split_gain': 0.0004729375363927215}
2024-12-02 17:24:06,844 - __main__ - INFO - Training ensemble models...
2024-12-02 17:24:06,844 - __main__ - INFO - Training xgboost...
2024-12-02 17:24:07,217 - __main__ - INFO - Training lightgbm...
2024-12-02 17:24:07,327 - __main__ - INFO - Training random_forest...
2024-12-02 17:24:08,356 - __main__ - INFO - Training gradient_boosting...
2024-12-02 17:24:09,279 - __main__ - INFO - Model saved successfully to output/AAPL_model_20241202_172409.joblib
2024-12-02 17:24:09,741 - __main__ - INFO - Analysis completed successfully
2024-12-02 17:25:01,275 - __main__ - INFO - Best trial: {'xgb_n_estimators': 483, 'xgb_max_depth': 3, 'xgb_learning_rate': 0.03597166214718373, 'xgb_subsample': 0.7567081200335803, 'xgb_colsample_bytree': 0.7898916957368048, 'xgb_min_child_weight': 3, 'xgb_gamma': 0.04005085959967513, 'xgb_reg_alpha': 1.6497846436674962e-08, 'xgb_reg_lambda': 0.001033015156578734, 'lgb_n_estimators': 635, 'lgb_max_depth': 3, 'lgb_learning_rate': 0.05848024521612116, 'lgb_subsample': 0.930298191535954, 'lgb_colsample_bytree': 0.6520446329122008, 'lgb_min_child_samples': 17, 'lgb_reg_alpha': 0.0037087364903843614, 'lgb_reg_lambda': 3.9347370873319476e-05, 'lgb_min_split_gain': 8.72508106011389e-06}
2024-12-02 17:25:01,275 - __main__ - INFO - Best score: 0.5003448275862068
2024-12-02 17:25:01,276 - __main__ - INFO - Training xgboost...
2024-12-02 17:25:01,540 - __main__ - INFO - Training lightgbm...
2024-12-02 17:25:01,673 - __main__ - INFO - Training random_forest...
2024-12-02 17:25:02,595 - __main__ - INFO - Training gradient_boosting...
2024-12-02 17:25:08,377 - __main__ - ERROR - Error in backtesting: Cannot set a DataFrame with multiple columns to the single column Strategy_Return
